<div class='well'>
  <h1> Problem Set Editor </h1>
  <h3> Editing: {{problem.name}}</h3>

  <div class="form-group">
    <label for="name" class="col-sm-2 control-label">Name</label>
    <input type="text" id="name" class="form-control" ng-disabled="previewMode" ng-model="problem.name"/>
  </div>

  <div class="form-group">
    <label for="desc" class="col-sm-2 control-label">Description</label>
    <textarea id="desc" class="form-control" rows="3" ng-model="problem.desc"></textarea>
  </div>

  <div class="form-group">
    <label for="course" class="col-sm-2 control-label">Course</label>
    <select id="course" ng-model="selectedCourse">
      <option ng-repeat="c in courses" value="{{c.key.name}}">{{c.key.name}}
    </select>
  </div>


</div>

<div class="well pe" ng-init="init()">
  <h3>Questions</h3>

  <div class="add-field">
    <select ng-model="addField.new" ng-options="type.name as type.value for type in addField.types"></select>
    <button type="submit" class="btn" ng-click="addNewField()"><i class="icon-plus"></i> Add Question</button>
  </div>
  <hr>
  <p ng-show="problem.questions.length == 0">No questions added yet.</p>

  <div close-others="accordion.oneAtATime">
    <div heading="{{field.field_title}}" ng-repeat="field in problem.questions">

      <div class="accordion-edit">
        <button class="btn btn-danger pull-right" type="button" ng-click="deleteField(field.field_id)">Delete</button>

        <div class="form-group">
          <div class="span2">Question Title:</div>
          <div class="span4"><input type="text" ng-model="field.field_title" value="{{field.field_title}}"></div>
          <div class="span2">Full Question:</div>
          <div class="span4">
            <textarea class="form-control" rows="3" ng-model="field.field_question"
                      value="{{field.field_question}}"></textarea>
          </div>
        </div>

        <div class="form-group">
          <label for="formula{{$index}}">Answer Formula:</label>
          <textarea id="formula{{$index}}" class='mathdoxformula' rows='10' cols='80'>{{field.field_formula}}</textarea>
          <button class="btn btn-default btn-sm" ng-click="checkCalculation($index)">Check Formula</button>
          <label for="formula{{$index}}">Answer Variables:</label>
          <button class="btn btn-default btn-sm" ng-click="addVar()">Add a variable</button>
          <div>
            <label ng-show="calcResult[$index]">Formula Result:</label>
            <textarea disabled ng-show="calcResult[$index]">{{calcResult[$index]}}</textarea>
          </div>
        </div>

        <div class="form-group" ng-show="showAddOptions(field)">
          <div class="span2">Question Options:</div>
          <div class="span6">
            <div ng-repeat="option in field.field_options">
              <input type="text" ng-model="option.option_title" value="{{option.option_title}}">
              <a class="btn btn-danger btn-mini right" type="button" ng-click="deleteOption(field, option)"></a>
              <span class="label label-inverse">Value: {{ option.option_value }}</span>
            </div>
            <button class="btn btn-primary btn-small" type="button" ng-click="addOption(field)">Add Option
            </button>
          </div>
        </div>

      </div>
      <hr/>
    </div>
  </div>

</div>

<p class="text-center">
  <button class="btn btn-primary right" type="button" ng-click="previewOn()">Preview
    Problem Set
  </button>
  <button class="btn btn-danger right" type="button" ng-click="reset()">Reset
  </button>

  <button class="btn btn-success" type="button" ng-click="saveSet(problem)">Save Problem Set</button>
</p>

<br>
<hr>
<a ng-show="!showJson" ng-click="showJson = true">Show form json object</a>
<a ng-show="showJson" ng-click="showJson = false">Hide form json object</a><br><br>
<div ng-show="showJson">
  <h4>Problem Set Object Content:</h4>
  <pre>{{ problem | json }}</pre>
</div>
</div>

<div class="form-fields-preview" ng-show="previewMode">
  <form-directive form="previewForm"></form-directive>

  <p class="text-center">
    <button class="btn btn-primary btn-large right" type="button" ng-click="previewOff()"><i
      class="icon-arrow-left icon-white"></i> Back to Create Mode
    </button>
  </p>
</div>
</div>

